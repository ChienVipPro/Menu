<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tạo mã QR Chuyển khoản</title>
  <style>
    body {font-family: Arial, sans-serif; margin:0; padding:20px; background:#0b1020; color:#fff;}
    .wrap {max-width: 800px; margin:auto;}
    .card {background:#121a32; padding:20px; border-radius:12px; margin-bottom:20px;}
    label {display:block; margin:10px 0 5px; font-size:14px;}
    input, select {width:100%; padding:10px; border-radius:8px; border:1px solid #333; background:#0e1530; color:#fff;}
    button {padding:10px 15px; border:none; border-radius:8px; cursor:pointer; font-weight:bold;}
    .btn {background:#2a3a85; color:#fff;}
    .btn.ghost {background:transparent; border:1px solid #555;}
    .url {background:#0a132b; padding:10px; border-radius:8px; margin-top:10px; word-break:break-all;}
    .qrbox {display:flex; justify-content:center; padding:20px;}
  </style>
</head>
<body>
  <div class="wrap">
    <h2>Tạo mã QR chuyển khoản</h2>
    <div class="card">
      <label>Số tài khoản</label>
      <input id="acc" placeholder="VD: 0123456789">

      <label>Ngân hàng</label>
      <select id="bank">
        <option value="">--Chọn ngân hàng--</option>
        <option value="VCB">Vietcombank (VCB)</option>
        <option value="TCB">Techcombank (TCB)</option>
        <option value="MB">MB Bank (MB)</option>
        <option value="ACB">ACB</option>
        <option value="VIB">VIB</option>
        <option value="BIDV">BIDV</option>
        <option value="VPB">VPBank (VPB)</option>
        <option value="TPB">TPBank (TPB)</option>
        <option value="SCB">Sacombank (SCB)</option>
        <option value="AGB">Agribank (AGB)</option>
      </select>

      <label>Số tiền (VND)</label>
      <input id="amount" placeholder="VD: 500000">

      <label>Nội dung</label>
      <input id="des" placeholder="VD: Thanh toan don hang #1234">

      <label>Kích thước QR (px)</label>
      <input id="size" type="number" value="360" min="128" max="1024">

      <div style="margin-top:15px;">
        <button class="btn" onclick="copyUrl()">Sao chép URL</button>
        <a id="openUrl" class="btn ghost" target="_blank">Mở tab mới</a>
        <a id="saveImg" class="btn" download="qr.png">Tải ảnh</a>
      </div>

      <div class="url" id="urlBox"></div>
    </div>

    <div class="card">
      <h3>Xem trước QR</h3>
      <div class="qrbox">
        <div id="qrcode"></div>
      </div>
    </div>
  </div>

  <!-- QRCode.js -->
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
  <script>
    const acc = document.getElementById("acc");
    const bank = document.getElementById("bank");
    const amount = document.getElementById("amount");
    const des = document.getElementById("des");
    const size = document.getElementById("size");
    const urlBox = document.getElementById("urlBox");
    const openUrl = document.getElementById("openUrl");
    const saveImg = document.getElementById("saveImg");

    let qr;

    function buildUrl() {
      const a = acc.value.trim();
      const b = bank.value.trim();
      const m = amount.value.trim();
      const d = des.value.trim();

      let params = [];
      if (a) params.push("acc=" + encodeURIComponent(a));
      if (b) params.push("bank=" + encodeURIComponent(b));
      if (m) params.push("amount=" + encodeURIComponent(m));
      if (d) params.push("des=" + encodeURIComponent(d));

      return "https://qr.sepay.vn/img?" + params.join("&");
    }

    function updateQR() {
      const url = buildUrl();
      urlBox.textContent = url;
      openUrl.href = url;
      saveImg.href = url;

      const s = parseInt(size.value) || 360;
      document.getElementById("qrcode").innerHTML = "";
      qr = new QRCode(document.getElementById("qrcode"), {
        text: url,
        width: s,
        height: s,
        correctLevel: QRCode.CorrectLevel.H
      });
    }

    function copyUrl() {
      navigator.clipboard.writeText(urlBox.textContent).then(() => {
        alert("Đã sao chép URL!");
      });
    }

    [acc, bank, amount, des, size].forEach(el => el.addEventListener("input", updateQR));

    updateQR();
  </script>
</body>
</html>
